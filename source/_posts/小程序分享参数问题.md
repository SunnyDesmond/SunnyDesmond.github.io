---
title: 小程序分享参数问题
date: 2018-11-07 13:53:56
keywords:
description: 微信小程序
tags: [微信小程序]
categories: "微信小程序"
---
## 小程序分享
微信小程序分享主要是使用自带的`onShareAppMessage`方法调起分享组件。
主要写法就是
```
onShareAppMessage:function(res){
    if(res.from == 'button'){
        //按钮授权 调用share
    }
     return {
      title: shareTitle,
      path: shareUrl,
      imageUrl: shareImageUrl
    }
}
```
<!--more-->
只要添加如上代码即可用过小程序上面`···`分享出去当前的页面，也可以通过在`button`添加 `<button class='share-btn' open-type='share'>分享</button>` 即可调起分享方法。

## 诡异的bug
分享小程序分享的时候只要照着上面的写法就不会有问题。但是最近在使用分享的时候发现一个诡异的bug。。😏😏
具体如下： 在一个详情页分享一个跳转到首页的链接，带上一个参数。然后用户点击对应这个链接跳转到首页可以在`options`中取到对应的参数。这个是很ok的。但是如果这个用户在这个页面上，继续分享不带参数的链接给另外一个人，那个人接收到的链接上，居然带上了上个页面的参数！🙃🙃，然而，查看分享出去的链接上，并没有带上这个参数。。。
太诡异了。。。
## 阿拉丁
一开始以为是微信的bug，甚至跑到了微信社区里留言。。。后来把这个问题，在另外一个项目上跑，发现并没有此问题。。。且使用的基础库一样。。。。顿时不淡定了。。。🙄🙄
 后来发现，我们小程序中为了统计，加入阿拉丁统计插件。。。然后发现目前使用的是一个号称`7.0.0`的版本。。。
 然后又去官网上面下载了一个也是`7.0.0`版本的sdk，覆盖后，发现。。好了😡😡。
 好吧，后来找到阿拉丁官方，官方技术人员也表示之前确实有这个问题，不过后来修复了。。。但是版本号却没有改。。。。
 最后如果，大家也遇到类似问题，可以尝试去阿拉丁官网下载最新的sdk替换一下。。。。


